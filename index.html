<!DOCTYPE html>
<html>
  <head>
    <title>Title</title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, interactive-widget=resizes-content"
    />

    <style>
      body {
        margin: 0;
        font-size: 16px;
        width: 100%;
        height: 100%;
      }

      input {
        font-size: 16px;
      }

      #container {
        height: 100%;
      }

      .sticky-section {
        position: relative;
      }

      .sticky-header {
        position: sticky;
        top: 0;
        background: blueviolet;
        z-index: 100;
        padding: 10px;
      }
    </style>
  </head>
  <body>
    <div id="container">
      <main id="main">
        <div style="height: 500px; background: #f0f0f0; padding: 20px">
          <h1>Dummy Content</h1>
          <p>This is some dummy content before the sticky section.</p>
        </div>

        <div class="sticky-section">
          <div class="sticky-header">header</div>
          <textarea
            id="textInput"
            style="
              background-color: antiquewhite;
              width: 378px;
              height: 2000px;
              font-size: 16px;
            "
          ></textarea>
        </div>
      </main>
    </div>

    <script>
      // Handle visual viewport changes
      if (window.visualViewport) {
        const updateViewportHeight = () => {
          // Use requestAnimationFrame to handle iOS Safari frame delay
          requestAnimationFrame(() => {
            document.documentElement.style.setProperty(
              "--vh",
              `${window.visualViewport.height}px`
            );
          });
        };

        window.visualViewport.addEventListener("resize", updateViewportHeight);
        window.visualViewport.addEventListener("scroll", updateViewportHeight);

        // Initial setup
        updateViewportHeight();
      }

      // Prevent window scroll when keyboard is open
      // const handleScroll = () => {
      //   window.scrollTo(0, 0);
      // };

      // window.addEventListener("scroll", handleScroll);

      // Clean up event listeners when the page is unloaded
      window.addEventListener("unload", () => {
        window.removeEventListener("scroll", handleScroll);
        if (window.visualViewport) {
          window.visualViewport.removeEventListener(
            "resize",
            updateViewportHeight
          );
          window.visualViewport.removeEventListener(
            "scroll",
            updateViewportHeight
          );
        }
      });
    </script>
  </body>
</html>
